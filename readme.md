# 3D Bin Packing

三维在线/离线装箱算法实现

## 问题背景

物流公司在流通过程中, 需要将打包完毕的箱子装入到一个货车的车厢中, 为了提高物流效率, 需要将车厢尽量填满, 显然, 车厢如果能被 `100%` 填满是最优的, 但通常认为, 车厢能够填满 `85%`, 可认为装箱是比较优化的.

## 问题描述

设车厢为长方形, 其长宽高分别为 `L`, `W`, `H`; 共有 `n` 个箱子, 箱子也为长方形, 第 `i` 个箱子的长宽高为 `l_i`, `w_i`, `h_i` (`n` 个箱子的体积总和是要远远大于车厢的体积), 做以下假设和要求:

1. 长方形的车厢共有 `8` 个角, 并设靠近驾驶室并位于下端的一个角的坐标为 `(0,0,0)`, 车厢共 `6` 个面, 其中长的 `4` 个面, 以及靠近驾驶室的面是封闭的, 只有一个面是开着的, 用于工人搬运箱子;
2. 需要计算出每个箱子在车厢中的坐标, 即每个箱子摆放后, 其和车厢坐标为 `(0,0,0)` 的角相对应的角在车厢中的坐标, 并计算车厢的填充率.

问题分解为基础和高级部分.

基础部分:

- 所有的参数为整数;
- 静态装箱, 即从 `n` 个箱子中选取 `m` 个箱子, 并实现 `m` 个箱子在车厢中的摆放 (无需考虑装箱的顺序, 即不需要考虑箱子从内向外, 从下向上这种在车厢中的装箱顺序);
- 所有的箱子全部平放, 即箱子的最大面朝下摆放;
- 算法时间不做严格要求, 只要 `1` 天内得出结果都可.

高级部分:

- 参数考虑小数点后两位;
- 实现在线算法, 也就是箱子是按照随机顺序到达, 先到达先摆放;
- 需要考虑箱子的摆放顺序, 即箱子是从内到外, 从下向上的摆放顺序;
- 因箱子共有 `3` 个不同的面, 所有每个箱子有 `3` 种不同的摆放状态;
- 算法需要实时得出结果, 即算法时间小于等于 `2` 秒.

## 算法思路

### 坐标系

确定车厢的内侧下方某个顶点作为原点, 建立 xyz 三维坐标, 同时物品也相对于车厢原点, 确立物品自己的基准点, 作为物品的摆放位置, 而物品的长宽高则是从这个基准点的延伸方向.

### 物品的属性

物品具有长宽高, 以及体积.

物品具有一个摆放基准点, 与六种旋转摆放方式, 记录在 `ROTATIONS` 变量里.

### 摆放策略

摆放箱子的时候, 通常都从最里面开始摆放, 然后紧邻已有的物品进行堆叠, 这是人们日常生活经验中去最大化利用空间的方式.

对应到算法中, 第一个物品一定从车厢的原点 `(0, 0, 0)` 开始摆放, 然后后续物品依次按策略选择摆放在厢内已有物品紧邻的位置上.

摆放策略分为两步, 第一步是选择摆放点, 要求尽可能离原点靠近; 第二步是选择旋转方向, 要求尽可能充分利用当前摆放点的周边空间.

## 数据集

车厢的尺寸为 `(587, 233, 220)`.

物品测试数据集共有 5 组, 分别包含 3, 5, 8, 10, 15 种不同的尺寸的物品, 而每一组里有 5 小类不同情况.

## 测试结果

简略结果见 [output.txt](output.txt), 详细结果见 [output2.txt](output2.txt).
